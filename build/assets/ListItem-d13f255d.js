import{k as bt,v as ft,w as f,__tla as ut}from"./vue-qrcode.esm-9e0a6c12.js";import{_ as u,o as n,c as m,a as e,j as xt,n as d,g as F,w as T,t as g,q as x,h as p,F as b,r as k,i as v,b as I,l as kt}from"./_plugin-vue_export-helper-8676f0c8.js";import{u as vt,__tla as wt}from"./market-6d56493b.js";let E,L,Ct=Promise.all([(()=>{try{return ut}catch{}})(),(()=>{try{return wt}catch{}})()]).then(async()=>{const A={components:{RecycleScroller:bt},props:["list","type","subtype","iffav","ifeco"],emits:["fetchFavs"],data(){return{searchTerm:"",searched:!1,filter:0}},computed:{markets(){try{if(!this.list)return[];const s=[...this.searchTerm?this.list.filter(t=>t.symbol.toUpperCase().includes(this.searchTerm.toUpperCase())):this.list],r=[(t,a)=>t.symbol.localeCompare(a.symbol),(t,a)=>a.symbol.localeCompare(t.symbol),(t,a)=>a.price-t.price,(t,a)=>t.price-a.price,(t,a)=>a.change-t.change,(t,a)=>t.change-a.change];return this.filter?s.sort(r[this.filter-1]):s}catch(s){console.log(s)}}},watch:{searchTerm(){this.markets},filter(){this.markets}},methods:{priceFormatter(s,r=8,t=2,a=","){return s==null||isNaN(s)?0:(s=parseInt(s)!==0?parseFloat(s).toFixed(t):parseFloat(s).toFixed(r),s=parseInt(s)!==0?s.toString().replace(/\B(?=(\d{3})+(?!\d))/g,a):s,s)},async addToWatchlist(s,r,t){await axios.post("/user/watchlist/store",{currency:s,pair:r,type:t}).then(a=>{this.$toast[a.type](a.message),this.$emit("fetchFavs")}).catch(a=>{this.$toast.error(a.response.data.message)})},async removeFromWatchlist(s){await axios.post("/user/watchlist/delete",{id:s}).then(r=>{this.$toast[r.type](r.message),this.$emit("fetchFavs")}).catch(r=>{this.$toast.error(r.response.data.message)})}}},M={class:"mb-3 flex items-center"},j=e("label",{for:"simple-search",class:"sr-only"},"Search",-1),O={class:"relative w-full"},z=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("svg",{"aria-hidden":"true",class:"h-4 w-4 text-gray-500 dark:text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1),R={class:"mb-2 flex justify-between text-start text-xs"},P=e("span",{class:"mr-1"},"Market",-1),U={class:"flex flex-col",style:{"font-size":"8px"}},W=e("span",{class:"mr-1"},"Price",-1),D={class:"flex flex-col",style:{"font-size":"8px"}},V=e("span",{class:"mr-1"},"%",-1),N={class:"flex flex-col",style:{"font-size":"8px"}},q={class:"flex justify-between text-start"},B=["onClick"],H=e("i",{class:"text-secondary bi bi-star mr-1"},null,-1),Z=[H],G={class:"text-dark fw-bold"},J={class:"text-secondary fw-bold"};function K(s,r,t,a,l,i){const h=x("router-link"),o=x("RecycleScroller");return n(),m("div",null,[e("div",M,[j,e("div",O,[z,xt(e("input",{id:"simple-search","onUpdate:modelValue":r[0]||(r[0]=c=>l.searchTerm=c),type:"text",class:"block w-full rounded border border-gray-300 bg-gray-50 p-1 pl-10 text-sm text-gray-900 focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-blue-500 dark:focus:ring-blue-500",placeholder:"Search"},null,512),[[ft,l.searchTerm]])])]),e("div",R,[e("a",{class:"flex",onClick:r[1]||(r[1]=c=>l.filter!=1?l.filter==2?l.filter=0:l.filter=1:l.filter=2)},[P,e("div",U,[e("i",{class:d(["bi",l.filter==1?"text-warning bi-caret-up-fill":"bi-caret-up"]),style:{"line-height":"0px !important"}},null,2),e("i",{class:d(["bi",l.filter==2?"text-warning bi-caret-down-fill":"bi-caret-down"]),style:{"line-height":"0px !important"}},null,2)])]),e("a",{class:"flex",onClick:r[2]||(r[2]=c=>l.filter!=3?l.filter==4?l.filter=0:l.filter=3:l.filter=4)},[W,e("div",D,[e("i",{class:d(["bi",l.filter==3?"text-warning bi-caret-up-fill":"bi-caret-up"]),style:{"line-height":"0px !important"}},null,2),e("i",{class:d(["bi",l.filter==4?"text-warning bi-caret-down-fill":"bi-caret-down"]),style:{"line-height":"0px !important"}},null,2)])]),e("a",{class:"flex",onClick:r[3]||(r[3]=c=>l.filter!=5?l.filter==6?l.filter=0:l.filter=5:l.filter=6)},[V,e("div",N,[e("i",{class:d(["bi",l.filter==5?"text-warning bi-caret-up-fill":"bi-caret-up"]),style:{"line-height":"0px !important"}},null,2),e("i",{class:d(["bi",l.filter==6?"text-warning bi-caret-down-fill":"bi-caret-down"]),style:{"line-height":"0px !important"}},null,2)])])]),F(o,{class:"scroller text-xs",style:{"margin-right":"-10px"},items:i.markets,"item-size":22,"key-field":"symbol"},{default:T(({item:c})=>[e("div",q,[e("div",null,[e("button",{type:"button",class:"not-watchlisted",style:{background:"transparent",border:"transparent"},onClick:f(y=>t.iffav?i.removeFromWatchlist(c.id):i.addToWatchlist(c.currency,c.pair,t.ifeco?1:2),["prevent"])},Z,8,B),F(h,{to:"/"+t.type+"/"+(t.subtype!="non"?t.subtype+"/":"")+c.currency+(t.ifeco?"-":"/")+c.pair},{default:T(()=>[e("span",G,g(c.currency)+"/",1),e("span",J,g(c.pair),1)]),_:2},1032,["to"])]),e("span",{class:d(["text-start",c.class])},g(i.priceFormatter(c.price)||""),3),e("span",{class:d(["mr-1 text-start",c.classChange])},g(i.priceFormatter(c.change,2)||""),3)])]),_:1},8,["items"])])}const Q=u(A,[["render",K]]),X={components:{MarketList:Q},props:["type","subtype"],setup(){return{marketStore:vt()}},data(){return{old:[],oldChange:[],ext,provider,activeItem:"USDT",tickerElements:[],changeElements:[]}},computed:{},created(){this.fetchMarkets(),this.fetchFavs(),ext.eco==1&&this.$route.path.includes("binary")!=!0&&this.fetchEcos(),this.loop()},mounted(){},methods:{async fetchMarkets(){this.marketStore.markets.length==0&&await this.marketStore.fetch_markets(provider)},async fetchFavs(){this.marketStore.favs.length==0&&await this.marketStore.fetch_favs()},async fetchEcos(){this.marketStore.ecos.length==0&&await this.marketStore.fetch_ecos()},isActive(s){return this.activeItem===s},setActive(s){this.activeItem=s},scrollLeft(){var s=$(".nf").scrollLeft();$(".nf").animate({scrollLeft:s-200},800)},scrollRight(){var s=$(".nf").scrollLeft();$(".nf").animate({scrollLeft:s+200},800)},updateTickerElements(s){s.forEach(r=>{const{tickerElement:t,newValue:a,symbol:l}=r,i=this.old[l];a>i?t.text(a).addClass("text-success").removeClass("text-danger"):a<i&&t.text(a).addClass("text-danger").removeClass("text-success"),this.old[l]=a})},updateTickerIcons(s){s.forEach(r=>{const{tickerIcon:t,newValue:a,symbol:l}=r,i=this.old[l];a>i?t.addClass("bi-arrow-up text-success").removeClass("bi-arrow-down text-danger"):a<i&&t.addClass("bi-arrow-down text-danger").removeClass("bi-arrow-up text-success")})},updateChangeElements(s){s.forEach(r=>{const{changeElement:t,newValue:a,symbol:l}=r,i=this.old[l];a>i?t.text(`${this.formatTotal(a)}%`).addClass("bi-arrow-up text-success").removeClass("bi-arrow-down text-danger"):a<i?t.text(`${this.formatTotal(a)}%`).addClass("bi-arrow-down text-danger").removeClass("bi-arrow-up text-success"):t.text(`${this.formatTotal(a)}%`)})},handle(s){try{for(const[r,t]of Object.entries(s))if(t.last&&this.marketStore.markets[this.activeItem]&&this.marketStore.markets[this.activeItem][r]){this.marketStore.markets[this.activeItem][r].price=t.last;const a=!this.old||t.last>this.old[r];if(this.marketStore.markets[this.activeItem][r].class=a?"text-success":"text-danger",t.percentage){this.marketStore.markets[this.activeItem][r].change=t.percentage;const l=!this.oldChange||t.percentage>this.oldChange[r];this.marketStore.markets[this.activeItem][r].classChange=l?"text-success":"text-danger"}}this.old=Object.fromEntries(Object.entries(s).map(([r,t])=>[r,t.last]))}catch(r){console.log(r)}},async loop(){for(;window.location.href.indexOf(this.$route.params.symbol+"/"+this.$route.params.currency)>-1;)try{const s=await this.marketStore.exchange.fetchTickers();this.handle(s)}catch{break}},formatTotal(s){return ccxt.decimalToPrecision(s,ccxt.ROUND,3,ccxt.DECIMAL_PLACES,ccxt.PAD_WITH_ZERO)}}},Y={class:"Markets border border-gray-100 bg-white shadow dark:border-gray-700 dark:bg-gray-900"},tt={class:"mb-4 flex border-gray-200 dark:border-gray-800"},et=e("i",{class:"bi bi-chevron-left text-warning"},null,-1),rt=[et],at={id:"myTab",class:"nf flex-cols -mb-px flex overflow-x-hidden bg-gray-200 text-center text-sm font-medium dark:bg-gray-800",role:"tablist"},st=e("i",{class:"bi bi-star bi-icon"},null,-1),lt=[st],it={key:0},ct=e("i",{class:"bi bi-award bi-icon"},null,-1),ot=[ct],nt=["onClick"],dt=e("i",{class:"bi bi-chevron-right text-warning fs-6"},null,-1),ht=[dt],mt={id:"myTabContent",class:"px-3"};function gt(s,r,t,a,l,i){const h=x("MarketList");return n(),m("div",Y,[e("div",tt,[e("button",{class:"-mb-px bg-gray-200 px-1 hover:bg-gray-300 dark:bg-gray-800 dark:hover:bg-gray-700",onClick:r[0]||(r[0]=f(o=>i.scrollLeft(),["prevent"]))},rt),e("ul",at,[e("li",null,[e("small",null,[e("a",{class:d(["inline-block px-2 py-1 text-gray-600 dark:text-gray-300",i.isActive("fav")?"border-gray-300 bg-white text-gray-700 dark:bg-gray-900 dark:text-gray-300":"cursor-pointer border-transparent bg-gray-200 text-gray-400 hover:border-gray-300 hover:bg-gray-300 hover:text-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 dark:hover:text-gray-300"]),onClick:r[1]||(r[1]=o=>i.setActive("fav"))},lt,2)])]),l.ext.eco==1&&a.marketStore.ecos!=""?(n(),m("li",it,[e("small",null,[e("a",{class:d(["inline-block px-2 py-1 text-gray-600 dark:text-gray-300",i.isActive("eco")?"border-gray-300 bg-white text-gray-700 dark:bg-gray-900 dark:text-gray-300":"cursor-pointer border-transparent bg-gray-200 text-gray-400 hover:border-gray-300 hover:bg-gray-300 hover:text-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 dark:hover:text-gray-300"]),onClick:r[2]||(r[2]=o=>i.setActive("eco"))},ot,2)])])):p("",!0),(n(!0),m(b,null,k(a.marketStore.markets,(o,c,y)=>(n(),m("li",{key:y},[e("small",null,[e("a",{class:d(["inline-block px-2 py-1 text-gray-600 dark:text-gray-300",i.isActive(c)?"border-gray-300 bg-white text-gray-700 dark:bg-gray-900 dark:text-gray-300":"cursor-pointer border-transparent bg-gray-200 text-gray-400 hover:border-gray-300 hover:bg-gray-300 hover:text-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 dark:hover:text-gray-300"]),onClick:yt=>i.setActive(c)},g(c),11,nt)])]))),128))]),e("button",{class:"-mb-px bg-gray-200 px-1 hover:bg-gray-300 dark:bg-gray-800 dark:hover:bg-gray-700",onClick:r[3]||(r[3]=f(o=>i.scrollRight(),["prevent"]))},ht)]),e("div",mt,[l.activeItem==="fav"?(n(),v(h,{key:a.marketStore.favs.length,list:Object.values(a.marketStore.favs),type:t.type,subtype:t.subtype,iffav:"true",onFetchFavs:r[4]||(r[4]=o=>a.marketStore.fetch_favs())},null,8,["list","type","subtype"])):p("",!0),l.activeItem==="eco"?(n(),v(h,{key:a.marketStore.ecos.length,list:Object.values(a.marketStore.ecos),type:t.type,subtype:t.subtype,ifeco:"true",onFetchFavs:r[5]||(r[5]=o=>a.marketStore.fetch_favs())},null,8,["list","type","subtype"])):p("",!0),(n(!0),m(b,null,k(a.marketStore.markets,(o,c,y)=>(n(),m("div",{key:y,class:d(i.isActive(c)?"":"hidden")},[l.activeItem===c?(n(),v(h,{key:o.length,list:Object.values(o),type:t.type,subtype:t.subtype,onFetchFavs:r[6]||(r[6]=yt=>a.marketStore.fetch_favs())},null,8,["list","type","subtype"])):p("",!0)],2))),128))])])}let w,C,S,_;L=u(X,[["render",gt]]),w={name:["ListItem"],props:["data","type","color","limit","showLess"],computed:{items(){return this.showLess?this.data.slice(0,this.limit):this.data}}},C={key:0},S={class:"tdd quantity text-dark"},_={class:"tdd btc text-dark"};function pt(s,r,t,a,l,i){return n(!0),m(b,null,k(i.items,(h,o)=>(n(),m(b,null,[i.items&&i.items.length>0&&o<=t.limit?(n(),m("tr",C,[e("td",{class:"tdd price text-dark",style:I("color:"+t.color)},[e("span",null,g(h[0]),1)],4),e("td",S,[e("span",null,g(h[1]),1)]),e("td",_,[e("span",null,[kt(g(h[2])+" ",1),e("div",{class:d("percent_"+t.type),style:I("width:"+h[3]+"px")},null,6)])])])):p("",!0)],64))),256)}E=u(w,[["render",pt]])});export{E as L,L as M,Ct as __tla};
