function updateToolboxElementGraphZoom(){}function initToolboxChartControler(){$("[drawingtool]").off("click").click((function(){selectAddTextObject($(this).parent().attr("container"),$(this).attr("drawingtool"))})),$(".graph-tooledit").draggable({handle:".graph-tooledit-draggble"}),$(document).off("keyup").keyup((function(e){46==e.keyCode&&deleteSelectedGraphic()}))}function updateToolboxElementGraphZoomSingle(e){let t=[],i=0;$.each(chartList[e].graphic,(function(e,n){null!=n&&(t[i]=n,i++)})),chartList[e].graphic=t,$.each(chartList[e].graphic,(function(t,i){if(null==i.type)return!0;"line"!=i.type?chartList[e].option.graphic[t].position=chartList[e].graph.convertToPixel("grid",i.position):chartList[e].option.graphic[t].shape={x1:chartList[e].graph.convertToPixel("grid",i.shape.x1)[0],x2:chartList[e].graph.convertToPixel("grid",i.shape.x2)[0],y1:chartList[e].graph.convertToPixel("grid",i.shape.y1)[1],y2:chartList[e].graph.convertToPixel("grid",i.shape.y2)[1]}})),reloadContainerGraphic(e)}function generateIDGraphic(e){return chartList[e].graphic.length}function addTrendLine(e,t,i){let n=generateIDGraphic(e);chartList[e].graphic.push({type:"circle",id:"trendline-"+n+"-p1",shape:{cx:0,cy:0,r:7},position:[t,i],invisible:!1,silent:!1,style:{fill:"#131722",stroke:"#f3f3f3",lineWidth:1},ondrag:echarts.util.curry(changeTrendLineByPoint,n,e,1)}),chartList[e].graphic.push({type:"circle",id:"trendline-"+n+"-p2",shape:{cx:0,cy:0,r:7},position:[t,i],invisible:!1,silent:!1,style:{fill:"#131722",stroke:"#f3f3f3",lineWidth:1},ondrag:echarts.util.curry(changeTrendLineByPoint,n,e,2)}),chartList[e].graphic.push({type:"line",id:"trendline-"+n+"-line",shape:{x1:[t,i],x2:[t,i],y1:[t,i],y2:[t,i]},position:null,draggable:!0,silent:!1,invisible:!1,style:{stroke:"#ff0000",lineWidth:2},ondrag:echarts.util.curry(TrendLineMoved,n,e),onmouseover:echarts.util.curry(TrendLineOvered,n,e),onclick:echarts.util.curry(TrendLineClicked,n,e),onmouseout:echarts.util.curry(TrendLineOuted,n,e)}),reloadContainerGraphic(e)}let objectContainerSelected=null,containerObjectSelected=null,typeObjectSelected=null;function TrendLineOvered(e,t){$.each(chartList[t].graphic,(function(i,n){n.id!="trendline-"+e+"-p1"&&n.id!="trendline-"+e+"-p2"||(chartList[t].graphic[i].invisible=!1)})),reloadContainerGraphic(t)}function TrendLineOuted(e,t){objectContainerSelected==e&&containerObjectSelected==t||$.each(chartList[t].graphic,(function(i,n){n.id!="trendline-"+e+"-p1"&&n.id!="trendline-"+e+"-p2"||(chartList[t].graphic[i].invisible=!0)})),reloadContainerGraphic(t)}function TrendLineClicked(e,t){unselectSelectedGraphic(),containerObjectSelected=t,objectContainerSelected=e,typeObjectSelected="trendline",$.each(chartList[t].graphic,(function(i,n){n.id!="trendline-"+e+"-p1"&&n.id!="trendline-"+e+"-p2"||(chartList[t].graphic[i].style.lineWidth=1.5,chartList[t].graphic[i].invisible=!1)})),reloadToolBoxBar(t,e,"line"),reloadContainerGraphic(t)}function TrendLineMoved(e,t,i){}function changeTrendLineByPoint(e,t,i,n,r){let c=this.position,o=null,a=null;$.each(chartList[t].graphic,(function(n,r){r.id=="trendline-"+e+"-p"+i&&(chartList[t].graphic[n].position=chartList[t].graph.convertFromPixel("grid",c),o=chartList[t].graph.convertFromPixel("grid",c)),r.id=="trendline-"+e+"-p"+(2==i?1:2)&&(a=chartList[t].graphic[n].position),r.id=="trendline-"+e+"-line"&&(chartList[t].graphic[n].shape={x1:o,y1:o,x2:a,y2:a})})),reloadContainerGraphic(t)}let objectClick=null;function selectAddTextObject(e,t="text"){"text"==t?objectClick=function(){addText(e,currentDateSelected,currentValueSelected)}:"trendline"==t&&(objectClick=function(){addTrendLine(e,currentDateSelected,currentValueSelected)})}function addText(e,t,i,n="Text",r="#fff"){let c=generateIDGraphic(e);chartList[e].graphic.push({type:"text",id:"text-"+c,position:[t,i],style:{text:n,fill:r},onclick:echarts.util.curry(TextClicked,c,e)}),reloadContainerGraphic(e)}function changePositionText(e,t,i,n){let r=this.position;$.each(chartList[t].graphic,(function(i,n){n.id=="text-"+e&&(chartList[t].graphic[i].position=chartList[t].graph.convertFromPixel("grid",r))})),reloadContainerGraphic(t)}function TextClicked(e,t){unselectSelectedGraphic(),containerObjectSelected=t,objectContainerSelected=e,typeObjectSelected="text",reloadToolBoxBar(t,e,"text"),reloadContainerGraphic(t)}function addIcon(e){let t=generateIDGraphic(e);chartList[e].graphic.push({type:"image",id:"icon-"+t,position:["10/06/2018 07:00:00",7680],draggable:!0,rotation:30,style:{image:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHZpZXdCb3g9IjAgMCA4IDgiPgogIDxwYXRoIGQ9Ik0zIDB2MWg0djVoLTR2MWg1di03aC01em0xIDJ2MWgtNHYxaDR2MWwyLTEuNS0yLTEuNXoiIC8+Cjwvc3ZnPg==",width:"30",height:"30",fill:"#ff0000",stroke:"#ff0000"},ondrag:echarts.util.curry(changePositionIcon,t,e)}),reloadContainerGraphic(e)}function changePositionIcon(e,t,i,n){let r=this.position;$.each(chartList[t].graphic,(function(i,n){n.id=="icon-"+e&&(chartList[t].graphic[i].position=chartList[t].graph.convertFromPixel("grid",r))})),reloadContainerGraphic(t)}function reloadContainerGraphic(e){chartList[e].option.graphic=[],chartList[e].option.graphic=echarts.util.map(chartList[e].graphic,(function(t,i){return"line"==t.type?{type:t.type,shape:{x1:chartList[e].graph.convertToPixel("grid",t.shape.x1)[0],y1:chartList[e].graph.convertToPixel("grid",t.shape.y1)[1],x2:chartList[e].graph.convertToPixel("grid",t.shape.x2)[0],y2:chartList[e].graph.convertToPixel("grid",t.shape.y2)[1]},draggable:!0,ondrag:t.ondrag,onclick:t.onclick,invisible:t.invisible,silent:t.silent,onmouseover:t.onmouseover,onmouseout:t.onmouseout,style:t.style,z:99}:"text"==t.type?{type:t.type,id:t.id,position:chartList[e].graph.convertToPixel("grid",t.position),draggable:!0,ondrag:t.ondrag,style:t.style,z:101}:"image"==t.type?{type:t.type,id:t.id,rotation:t.rotation,position:chartList[e].graph.convertToPixel("grid",t.position),draggable:!0,ondrag:t.ondrag,style:t.style,z:102}:{type:t.type,position:chartList[e].graph.convertToPixel("grid",t.position),draggable:!0,ondrag:t.ondrag,invisible:t.invisible,silent:t.silent,shape:t.shape,style:t.style,z:100}})),chartList[e].graph.setOption(chartList[e].option)}function unselectSelectedGraphic(){if(null==containerObjectSelected)return!1;$.each(chartList[containerObjectSelected].graphic,(function(e,t){"trendline"==typeObjectSelected&&(t.id!="trendline-"+objectContainerSelected+"-p1"&&t.id!="trendline-"+objectContainerSelected+"-p2"||(chartList[containerObjectSelected].graphic[e].style.lineWidth=1,chartList[containerObjectSelected].graphic[e].invisible=!0))})),chartList[containerObjectSelected].graph.setOption(chartList[containerObjectSelected].option),$(".graph-tooledit").hide(),$(".graph-tooledit-cell-active").removeClass("graph-tooledit-cell-active")}function deleteSelectedGraphic(){if(null==objectContainerSelected)return!1;$.each(chartList[containerObjectSelected].graphic,(function(e,t){"trendline"==typeObjectSelected&&(null==t||t.id!="trendline-"+objectContainerSelected+"-p1"&&t.id!="trendline-"+objectContainerSelected+"-p2"&&t.id!="trendline-"+objectContainerSelected+"-line"||(chartList[containerObjectSelected].graphic[e].invisible=!0,chartList[containerObjectSelected].graphic[e].silent=!0))})),reloadContainerGraphic(containerObjectSelected)}function reloadToolBoxBar(e,t,i="line"){let n=$('.graph-tooledit[toolbox-container="'+e+'"]');$(".graph-tooledit").css("display","flex"),n.show(),n.find("[toolboxedit-type]").hide(),n.find('[toolboxedit-type="'+i+'"]').show();"line"==i&&$.each(chartList[e].graphic,(function(n,r){r.id=="trendline-"+t+"-line"&&loadToolBoxBarComponent(chartList[e].graphic[n],i,n,e)}))}function loadToolBoxBarComponent(e,t,i,n){let r=$('.graph-tooledit-cell[toolboxedit-type="'+t+'"]');$.each(r,(function(){let t=$(this);t.off("click").click((function(){$(".graph-tooledit-cell-active").removeClass("graph-tooledit-cell-active"),t.addClass("graph-tooledit-cell-active")}));let r=t.attr("toolboxedit-asset").split("->"),c=e;$.each(r,(function(e,t){c=c[t]})),t.hasClass("graph-tooledit-color")&&t.find("div.graph-tooledit-preview").css("background-color",c),t.hasClass("graph-tooledit-thickness")&&t.find("div.graph-tooledit-preview").css("height",c),t.find("li").off("click").click((function(){let e=$(this).attr("dropdown-item");1==r.length&&(chartList[n].graphic[i][r[0]]=e),2==r.length&&(chartList[n].graphic[i][r[0]][r[1]]=e),3==r.length&&(chartList[n].graphic[i][r[0]][r[1]][r[2]]=e),4==r.length&&(chartList[n].graphic[i][r[0]][r[1]][r[2]][r[3]]=e),reloadContainerGraphic(n),t.hasClass("graph-tooledit-color")&&t.find("div.graph-tooledit-preview").css("background-color",e),t.hasClass("graph-tooledit-thickness")&&t.find("div.graph-tooledit-preview").css("height",e)}))}))}
